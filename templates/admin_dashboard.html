{% extends "base.html" %}
{% block title %}Admin Dashboard - MK Barriault{% endblock %}
{% block content %}

<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Admin Dashboard</h1>
        <div class="d-flex gap-2">
            <a href="{{ url_for('admin_wishlist') }}" class="btn" style="background-color: #9874D3; color: white; border: none;">‚ú® View Wishlist</a>
            <a href="{{ url_for('admin_logout') }}" class="btn" style="background-color: #730132; color: white; border: none;">Logout</a>
        </div>
    </div>

    <!-- STATS OVERVIEW -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card text-white mb-3" style="background: linear-gradient(135deg, #B879E2, #B879E2);">
                <div class="card-body">
                    <h5 class="card-title">Messages & Suggestions</h5>
                    <h2>{{ stats.unread_contacts + stats.total_suggestions }}</h2>
                    <a href="{{ url_for('admin_messages_suggestions') }}" class="btn btn-light btn-sm">View All</a>
                </div>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="card text-white mb-3" style="background: linear-gradient(135deg, #9874D3, #9874D3);">
                <div class="card-body">
                    <h5 class="card-title">App/Website Requests</h5>
                    <h2>{{ stats.new_app_requests }}</h2>
                    <a href="{{ url_for('admin_app_requests') }}" class="btn btn-light btn-sm">View All</a>
                </div>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="card text-white mb-3" style="background: linear-gradient(135deg, #A55AFF, #A55AFF);">
                <div class="card-body">
                    <h5 class="card-title">Orders</h5>
                    <h2>{{ stats.pending_orders }}</h2>
                    <a href="{{ url_for('admin_orders') }}" class="btn btn-light btn-sm">View All</a>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card text-white mb-3" style="background: linear-gradient(135deg, #938FB7, #938FB7);">
                <div class="card-body">
                    <h5 class="card-title">Partnerships</h5>
                    <h2>{{ stats.total_partners }}</h2>
                    <a href="{{ url_for('admin_partners') }}" class="btn btn-light btn-sm">View All</a>
                </div>
            </div>
        </div>
    </div>

    {% if stats.pending_real_purchases > 0 %}
    <div class="alert" style="background: rgba(115,1,50, 0.15); border-left: 4px solid #D473D4; color: white; margin-bottom: 20px;">
        <h4 class="alert-heading">üö® {{ stats.pending_real_purchases }} Real Purchase Request(s)!</h4>
        <p>You have customers who want to actually buy your art/jewelry. Check the Real Purchases section!</p>
    </div>
    {% endif %}

    <!-- RECENT APP REQUESTS -->
    {% if stats.recent_app_requests and stats.recent_app_requests|length > 0 %}
    <div class="about-section">
    <div class="card mb-4" style="border: 2px solid #9874D3;">
        <div class="card-header" style="background: linear-gradient(135deg, #9874D3, #9874D3);">
            <h3 style="color: white; margin: 0;">üöÄ Recent App/Website Requests</h3>
        </div>
        <div class="card-body">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Type</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for req in stats.recent_app_requests %}
                    <tr>
                        <td>{{ req.submitted_at.strftime('%m-%d-%Y') }}</td>
                        <td><strong>{{ req.name }}</strong></td>
                        <td>{{ req.email }}</td>
                        <td>
                            <span class="badge" style="background: #9874D3; color: white;">{{ req.request_type }}</span>
                        </td>
                        <td>
                            <span class="badge badge-request-status-{{ req.status }}">
                                {{ req.status }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <a href="{{ url_for('admin_app_requests') }}" class="btn btn-sm" style="background: linear-gradient(135deg, #9874D3, #9874D3); color: white; border: none;">View All Requests</a>
        </div>
    </div>
    </div>
    {% endif %}

    <div class="about-section">
    <div class="card mb-4" style="border: 2px solid #918BFC;">
        <div class="card-header" style="background: linear-gradient(135deg, #B879E2, #B879E2);">
            <h3 style="color: white; margin: 0;">Recent Contact Submissions</h3>
        </div>
        <div class="card-body">
            {% if stats.recent_contacts %}
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Inquiry Type</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for contact in stats.recent_contacts %}
                    <tr>
                        <td>{{ contact.submitted_at.strftime('%m-%d-%Y') }}</td>
                        <td>{{ contact.name }}</td>
                        <td>{{ contact.email }}</td>
                        <td>{{ contact.inquiry_type }}</td>
                        <td>
                            <span class="badge badge-status-{% if contact.status == 'read' %}read{% else %}unread{% endif %}">
                                {{ contact.status }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <a href="{{ url_for('admin_messages_suggestions') }}" class="btn btn-sm" style="background: linear-gradient(135deg, #8F93BA, #8F93BA); color: white; border: none;">View All Messages</a>
            {% else %}
            <p>No contact submissions yet.</p>
            {% endif %}
        </div>
    </div>
    </div>

    {% if stats.recent_real_orders and stats.recent_real_orders|length > 0 %}
    <div class="about-section">
    <div class="card mb-4" style="border: 3px solid #9874D3;">
        <div class="card-header" style="background: linear-gradient(135deg, #B879E2, #E0B0FF);">
            <h3 style="color: white; margin: 0;">üî• Recent Real Purchase Requests</h3>
        </div>
        <div class="card-body">
            <div class="alert" style="background: rgba(212, 115, 212, 0.2); border-left: 4px solid #D473D4; color: white;">
                <strong>‚ö†Ô∏è Action Required!</strong> These customers want to actually purchase!
            </div>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Order #</th>
                        <th>Date</th>
                        <th>Customer</th>
                        <th>Email</th>
                        <th>Total</th>
                        <th>Items</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in stats.recent_real_orders %}
                    <tr>
                        <td><strong>{{ order.order_number }}</strong></td>
                        <td>{{ order.order_date.strftime('%m-%d-%Y') }}</td>
                        <td>{{ order.customer_name }}</td>
                        <td>{{ order.customer_email }}</td>
                        <td>${{ "%.2f"|format(order.total_amount) }}</td>
                        <td>
                            {% for item in order["items"] %}
                            {{ item.item_name }}<br>
                            {% endfor %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <a href="{{ url_for('admin_real_purchases') }}" class="btn btn-sm" style="background: linear-gradient(135deg, #D473D4, #BA55D3); color: white; border: none;">View All Real Purchases</a>
        </div>
    </div>
    </div>
    {% endif %}

    {% if stats.recent_partners %}
    <div class="about-section">
    <div class="card mb-4" style="border: 2px solid #9874D3;">
        <div class="card-header" style="background: linear-gradient(135deg, #938FB7, #938FB7);">
            <h3 style="color: white; margin: 0;">Recent Partnership Inquiries</h3>
        </div>
        <div class="card-body">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Business Name</th>
                        <th>Contact</th>
                        <th>Email</th>
                        <th>Interest Type</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for partner in stats.recent_partners %}
                    <tr>
                        <td>{{ partner.submitted_at.strftime('%m-%d-%Y') }}</td>
                        <td><strong>{{ partner.business_name }}</strong></td>
                        <td>{{ partner.contact_name }}</td>
                        <td>{{ partner.contact_email }}</td>
                        <td>
                            <span class="badge" style="background: #8F93BA; color: white;">{{ partner.interest_type }}</span>
                        </td>
                        <td>
                            <span class="badge badge-partner-status-{{ partner.status }}">
                                {{ partner.status }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <a href="{{ url_for('admin_partners') }}" class="btn btn-sm" style="background: linear-gradient(135deg, #8F93BA, #8F93BA); color: white; border: none;">View All Partnership Inquiries</a>
        </div>
    </div>
    </div>
    {% endif %}

</div>

<style>
    .card {
        margin-bottom: 20px;
    }
    .table {
        color: white;
    }
    .badge {
        padding: 5px 10px;
    }
    .badge-request-status-new {
        background: #E0B0FF;
        color: #1a0f2e;
    }
    .badge-request-status-contacted {
        background: #9874D3;
        color: white;
    }
    .badge-request-status-in_progress {
        background: #A55AFF;
        color: white;
    }
    .badge-request-status-completed {
        background: #28a745;
        color: white;
    }
</style>

{% endblock %}






