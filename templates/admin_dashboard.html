{% extends "base.html" %}
{% block title %}Admin Dashboard - MK Barriault{% endblock %}
{% block content %}

<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Admin Dashboard</h1>
        <div class="d-flex gap-2">
            <a href="{{ url_for('admin_wishlist') }}" class="btn-plain-mauve">✨ View Wishlist</a>
            <a href="{{ url_for('admin_logout') }}" class="btn-plain-grey">Logout</a>
        </div>
    </div>

    <div class= "holographic-grid">
        <div class="holographic-card">
            <h4>Messages & Suggestions</h4>
            <h2>Unread Messages: {{ stats.unread_contacts + stats.total_suggestions }}</h2>
                <a href="{{ url_for('admin_messages_suggestions') }}" class="btn-action">View All</a>
        </div>
    
        
        <div class="holographic-card">
            <h4>App/Website Requests</h4>
                <h2>{{ stats.new_app_requests }}</h2>
                    <a href="{{ url_for('admin_app_requests') }}" class="btn-action">View All</a>
        </div>
    
    
        <div class="holographic-card">
            <h4>Orders</h4>
                <h2>{{ stats.pending_orders }}</h2>
                    <a href="{{ url_for('admin_orders') }}" class="btn-action">View All</a>
        </div>
    
        <div class="holographic-card">
            <h4>Partnerships</h5>
                    <h2>{{ stats.total_partners }}</h2>
                    <a href="{{ url_for('admin_partners') }}" class="btn-action">View All</a>
        </div>
    </div>


    {% if stats.recent_app_requests and stats.recent_app_requests|length > 0 %} <!-- RECENT APP REQUESTS -->
    <p></p><div class="about-section">
    <div class="glass tiles">
        <div class= "glass-tile">
            <h4>Recent App/Website Requests</h4>
            <p><table class="admin-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Type</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for req in stats.recent_app_requests %}
                    <tr>
                        <td>{{ req.submitted_at.strftime('%m-%d-%Y') }}</td>
                        <td><strong>{{ req.name }}</strong></td>
                        <td>{{ req.email }}</td>
                        <td>
                            <span class="badge badge-request-status-new">{{ req.request_type }}</span>
                        </td>
                        <td>
                            <span class="badge badge-request-status-{{ req.status }}">
                                {{ req.status }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table></p>
            <a href="{{ url_for('admin_app_requests') }}" class="btn-action">View All Requests</a>
        </div>
    </div>
    </div>
    {% endif %}

    <p></p><div class="about-section">
    <div class="glass tiles">
        <div class= "glass-tile">
            <h4>Recent Contact Submissions</h4>
            {% if stats.recent_contacts %}
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Inquiry Type</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for contact in stats.recent_contacts %}
                    <tr>
                        <td>{{ contact.submitted_at.strftime('%m-%d-%Y') }}</td>
                        <td>{{ contact.name }}</td>
                        <td>{{ contact.email }}</td>
                        <td>{{ contact.inquiry_type }}</td>
                        <td>
                            <span class="badge badge-status-{% if contact.status == 'read' %}read{% else %}unread{% endif %}">
                                {{ contact.status }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <a href="{{ url_for('admin_messages_suggestions') }}" class="btn-action">View All Messages</a>
            {% else %}
            <p>No contact submissions yet.</p>
            {% endif %}
        </div>
    </div>
    </div>

    {% if stats.recent_real_orders and stats.recent_real_orders|length > 0 %}
    <p></p><div class="about-section">
    <div class="glass tiles">
        <div class= "glass-tile">
            <h4> Recent Real Purchase Requests</h4>
            <div class="alert" style="background: rgba(212, 115, 212, 0.2); border-left: 4px solid #D473D4; color: white;">
                <strong>⚠️ Action Required!</strong> These customers want to actually purchase!
            </div>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>Order #</th>
                        <th>Date</th>
                        <th>Customer</th>
                        <th>Email</th>
                        <th>Total</th>
                        <th>Items</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in stats.recent_real_orders %}
                    <tr>
                        <td><strong>{{ order.order_number }}</strong></td>
                        <td>{{ order.order_date.strftime('%m-%d-%Y') }}</td>
                        <td>{{ order.customer_name }}</td>
                        <td>{{ order.customer_email }}</td>
                        <td>${{ "%.2f"|format(order.total_amount) }}</td>
                        <td>
                            {% for item in order["items"] %}
                            {{ item.item_name }}<br>
                            {% endfor %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <a href="{{ url_for('admin_real_purchases') }}" class="btn-action">View All Real Purchases</a>
        </div>
    </div>
    </div>
    {% endif %}

    {% if stats.recent_partners %}
    <p></p><div class="about-section">
    <div class="glass tiles">
        <div class= "glass-tile">
            <h4>Recent Partnership Inquiries</h4>
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Business Name</th>
                        <th>Contact</th>
                        <th>Email</th>
                        <th>Interest Type</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for partner in stats.recent_partners %}
                    <tr>
                        <td>{{ partner.submitted_at.strftime('%m-%d-%Y') }}</td>
                        <td><strong>{{ partner.business_name }}</strong></td>
                        <td>{{ partner.contact_name }}</td>
                        <td>{{ partner.contact_email }}</td>
                        <td>
                            <span class="badge" style="background: #8F93BA; color: white;">{{ partner.interest_type }}</span>
                        </td>
                        <td>
                            <span class="badge badge-partner-status-{{ partner.status }}">
                                {{ partner.status }}
                            </span>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <a href="{{ url_for('admin_partners') }}" class="btn-action">View All Partnership Inquiries</a>
        </div>
    </div>
    </div>
   
    {% endif %}
</div>
{% endblock %}